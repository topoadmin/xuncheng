<!DOCTYPE html>
<html lang="zh-cmn-Hans" class="js cssanimations">

	<head>
		<meta charset="utf-8" />
		<title>寻城</title>
		<meta id="meta-keywords" name="keywords" content="寻城">
		<meta id="meta-description" name="description" content="寻城">
		<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
		<meta name="renderer" content="webkit">
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, minimal-ui" />
		<meta name="apple-mobile-web-app-title" content="寻城">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="format-detection" content="telephone=no, email=no" />
		<meta name="robots" content="index,follow" />
		<meta http-equiv="Cache-Control" content="no-siteapp">
		<link rel="icon" type="image/png" href="../assets/images/favicon.png">
		
		<link rel="stylesheet" type="text/css" href="../assets/css/amazeui.css" />
		<link rel="stylesheet" type="text/css" href="../assets/css/animate.css" />
		<link rel="stylesheet" type="text/css" href="../assets/css/swiper-3.4.0.min.css" />
		<link rel="stylesheet" type="text/css" href="//at.alicdn.com/t/font_tazxp6e5stznnrk9.css" />
		<link rel="stylesheet" type="text/css" href="../css/main.css" />
	</head>

	<body class="xc-bg">
		<div id="xc-app" class="xc-app xc-header-fixed" v-cloak>
			<header class="am-header xc-header">
				<div class="am-header-left am-header-nav">
					<a href="javascript:$.xuncheng.back();">
						<i class="am-header-icon iconfont icon-zuo"></i>
					</a>
				</div>
				<span class="am-header-title">商品详情</span>
				<div class="am-header-right am-header-nav">
					<a href="javascript:$.xuncheng.share();">
						<i class="am-header-icon iconfont icon-fenxiang icon-lg"></i>
					</a>
				</div>
			</header>

			<!-- 轮播 -->
			<div class="xc-banner xc-goods-banner" id="goods-banner">
				<div class="swiper-container">
					<div class="swiper-wrapper">
						<div class="swiper-slide" v-for="ptpic in productDetail.ptpicList">
							<a href="javascript:void(0);">
								<img class="swiper-lazy" src="../images/bg/480.jpg" :data-src="ptpic" />
							</a>
						</div>
					</div>
					<div class="swiper-pagination swiper-pagination-goods"></div>
				</div>
			</div>

			<div class="am-g xc-item-goods">
				<p class="xc-item-title">
					{{ productDetail.pname }}
				</p>
				<p class="price">
					<span class="xc-price">¥</span>
					<span class="price-txt">
						{{ productDetail.pprice }}
					</span>
				</p>
				<div class="xc-hr"></div>

				<p class="merchant">
					<img src="../images/icon/icon-dianpu.png" width="20">
					<span class="am-text-xs">{{ productDetail.pshop }}</span>
				</p>

			</div>

			<div class="am-g">

				<div class="xc-video-box" id="xc-video-box">
					<div class="xc-video-play">
						<i class="am-icon-play xc-video-play-icon"></i>
						<img class="lazy" src="../images/bg/480.jpg" />
					</div>

					<video class="xc-video" :src="productDetail.pvideo" controls="controls" loop="loop"></video>
				</div>

				<img v-for="pcpic in productDetail.pcpic" class="am-img-responsive lazy" :data-original="pcpic" src="../images/bg/750.jpg" />

				<div class="xc-list-box">
					<ul class="am-list">
						<li class="ta-ripple">
							<a href="javascript:;">
								<img class="xc-list-icon-left" src="../images/icon/icon-pInfo.png"/>
								<span>发现	{{productDetail.pfeature}}</span>
								<i class="iconfont icon-you xc-list-icon-right"></i>
							</a>
						</li>
					</ul>
				</div>

				<p class="am-padding-vertical-xs">用户评论({{commentData.length}})条</p>

				<div class="xc-comment">
					<div class="xc-comment-list-box">
						<ul class="xc-comment-list">
							<li v-for="cData in commentData">
								<div class="xc-comment-list-hd">
									<img class="xc-comment-avatar" :src="cData.userImg" />
									<div class="xc-comment-name">{{ cData.userName }}</div>
									<div class="xc-comment-time">{{ cData.time }}</div>
								</div>
								<div class="xc-comment-list-bd">
									<p class="xc-comment-content">
										{{ cData.content }}
									</p>
									<div class="xc-comment-imgs">
										<img v-for="cImgs in cData.imgs" :data-original="cImgs" src="../images/bg/goods-bg.jpg" />
									</div>
								</div>
							</li>
						</ul>
					</div>
					<div class="xc-comment-footer">
						<a :href="'../component/comment.html?id='+queryId">
							查看全部点评
						</a>
					</div>
				</div>

			</div>

			<footer class="xc-footer xc-footer-goods am-g">
				<div class="am-u-sm-4">
					<a class="am-u-sm-6" href="../user/index.html">
						<i class="iconfont icon-user icon-xxl"></i>
					</a>
					<a class="am-u-sm-6" href="../component/cart.html">
						<i class="iconfont icon-gouwuche icon-xxl"></i>
					</a>
				</div>
				<div class="am-u-sm-4 xc-add-btn">
					<a href="javascript:;" @click="addCart">
						加入购物车
					</a>
				</div>
				<div class="am-u-sm-4 xc-submit-btn">
					<a href="../component/order.html">
						立即购买
					</a>
				</div>
			</footer>

		</div>

		<script src="../assets/js/vue.min.js"></script>
		<script src="../assets/js/fastclick.min.js"></script>
		<script src="../assets/js/jquery.min.js"></script>
		<script src="../assets/js/amazeui.min.js"></script>
		<script src="../assets/js/amazeui.lazyload.min.js"></script>
		<script src="../assets/js/swiper-3.4.0.jquery.min.js"></script>
		<script src="../js/xuncheng.js"></script>
		<script type="text/javascript">
			window.vueModel = new Vue({
				el: "#xc-app",
				data: {
					uid: $.xuncheng.getUid(),
					queryId: $.xuncheng.getUrlParam('id'),
					productDetail: {},
					commentData: []
				},
				methods: {
					addCart: function(){
						$.get('http://m.xunchengweidao.com/mca', {
							uid: vueModel.uid,
							pid: vueModel.queryId,
							cnum: 1
						}, function(data) {
							window.location.href = '../component/cart.html'
						}).fail(function(result) {
							$.DialogFx.alert(result.responseJSON.showMessage || '服务器内部错误');
						})
					}
				}
			});

			;
			(function() {
				$.getJSON('http://m.xunchengweidao.com/mpd', {pid: vueModel.queryId}, function(data) {
					if(data.resultCode != 10000){
						$.DialogFx.alertError(data.showMessage || '商品数据请求失败')
						return false;
					}
					data.productDetail.ptpicList = data.productDetail.ptpic.split(',');
					data.productDetail.pcpicList = data.productDetail.pcpic.split(',');
						
					vueModel.productDetail = data.productDetail;
					vueModel.$nextTick(function() {
						new Swiper('#goods-banner>.swiper-container', {
							pagination: '.swiper-pagination',
							paginationClickable: true,
							lazyLoading: true,
							lazyLoadingInPrevNext: true,
							lazyLoadingInPrevNextAmount: 2
						});
						$('img.lazy').lazyload();
					})
				}).fail(function() {
					$.DialogFx.alertError(data.showMessage || '商品数据请求失败')
				})
			}());

			$(function() {
				$.getJSON('../js/data/comment.json', function(data) {
					vueModel.commentData = data;
					vueModel.$nextTick(function() {
						$('.xc-comment-imgs > img').lazyload();
					})
				}).fail(function() {
					$.DialogFx.alert('评论服务器内部错误')
				})
			})
		</script>
	</body>

</html>